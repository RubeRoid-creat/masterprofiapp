# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å–∞–π—Ç–µ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ **"–ú–∞—Ä—à—Ä—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"**.

### –ü—Ä–∏—á–∏–Ω–∞:
Backend API endpoint `/api/orders/from-website` –≤–æ–∑–≤—Ä–∞—â–∞–ª **404 Not Found**, —Ö–æ—Ç—è:
- ‚úÖ Backend —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
- ‚úÖ –†–æ—É—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ–¥–µ (`backend/routes/orders.js`)
- ‚ùå –†–æ—É—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend)

---

## ‚úÖ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Mock —Ä–µ–∂–∏–º)

–ü–æ–∫–∞ backend –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω, —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **mock —Ä–µ–∂–∏–º–µ**:

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å

### –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚ùå –ó–∞–∫–∞–∑—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ú–∞—Å—Ç–µ—Ä–∞ –ù–ï –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå –ó–∞–∫–∞–∑—ã –ù–ï –≤–∏–¥–Ω—ã –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### –§–∞–π–ª—ã —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:
1. **`website/app/api/orders/route.ts`** - –≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç mock
2. **`website/app/api/orders-mock/route.ts`** - mock endpoint
3. **`website/app/order/page.tsx`** - —É–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
4. **`website/diagnose-backend.ps1`** - —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üöÄ –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è SSH –¥–æ—Å—Ç—É–ø)

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@212.74.227.208
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å backend

```bash
pm2 list
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ id  ‚îÇ name     ‚îÇ mode ‚îÇ ‚Ü∫    ‚îÇ status ‚îÇ cpu     ‚îÇ memory ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0   ‚îÇ backend  ‚îÇ fork ‚îÇ 0    ‚îÇ online ‚îÇ 0%      ‚îÇ 50.0mb ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend

```bash
pm2 restart backend
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

```bash
pm2 logs backend --lines 50
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
‚úÖ –ü–æ–ª–µ inn –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ masters
üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
```

### –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å endpoint

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
curl -X POST http://localhost:3000/api/orders/from-website \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test",
    "phone": "+79001234567",
    "email": "test@test.com",
    "device_type": "–•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫",
    "device_brand": "Samsung",
    "problem_description": "–¢–µ—Å—Ç",
    "address": "–ú–æ—Å–∫–≤–∞",
    "latitude": 55.751244,
    "longitude": 37.618423,
    "desired_repair_date": "2025-12-15",
    "arrival_time": "10:00",
    "urgency": "planned",
    "priority": "regular"
  }'
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "message": "–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω",
  "order": {
    "id": 123,
    "order_number": "ORD-2025-0001",
    ...
  }
}
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

```powershell
cd Z:\BestAPP\website
.\diagnose-backend.ps1
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
[4/5] Checking /api/orders/from-website endpoint...
  [OK] from-website endpoint works!
```

### –®–∞–≥ 7: –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ API –≤ —Å–∞–π—Ç

–í —Ñ–∞–π–ª–µ `website/app/api/orders/route.ts` —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–¥ –∏ —É–¥–∞–ª–∏—Ç—å mock:

```typescript
// –£–¥–∞–ª–∏—Ç—å mock –∫–æ–¥
// –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:
try {
  const { sendOrderToAdmin } = await import('@/lib/admin-api')
  const adminResponse = await sendOrderToAdmin({...})
  return NextResponse.json({...})
} catch (error) {
  ...
}
```

### –®–∞–≥ 8: –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å

```bash
git add website/app/api/orders/route.ts
git commit -m "fix: restore real backend API for orders"
git push origin main
```

---

## üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

```powershell
cd Z:\BestAPP\website
.\diagnose-backend.ps1
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
[4/5] Checking /api/orders/from-website endpoint...
  [FAIL] from-website endpoint returns: 404
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
[4/5] Checking /api/orders/from-website endpoint...
  [OK] from-website endpoint works!
  [INFO] Response: {"message":"–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω","order":{...}}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: Mock —Ä–µ–∂–∏–º (—Ç–µ–∫—É—â–∏–π)

```powershell
$testBody = @{
    address = "–¢–≤–µ—Ä—å, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è 1"
    equipmentType = "–°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞"
    problemType = "–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è"
    brand = "Samsung"
    date = "2025-12-20"
    time = "14:00"
    description = "–¢–µ—Å—Ç"
    name = "–¢–µ—Å—Ç"
    phone = "+79001234567"
    email = "test@example.com"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:3000/api/orders" -Method POST -Body $testBody -ContentType "application/json"
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "success": true,
  "orderId": 1765717120972,
  "orderNumber": "MOCK-1765717120972",
  "message": "–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)",
  "warning": "Backend API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ó–∞–∫–∞–∑ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑—É."
}
```

### –¢–µ—Å—Ç 2: –†–µ–∞–ª—å–Ω—ã–π backend (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

```powershell
# –î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π ID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
# warning –¥–æ–ª–∂–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç

### –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ):
- [x] –°–æ–∑–¥–∞–Ω mock endpoint
- [x] –§–æ—Ä–º–∞ –∑–∞–∫–∞–∑–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã

### –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è):
- [ ] –ü–æ–ª—É—á–µ–Ω SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω: `pm2 restart backend`
- [ ] Endpoint `/api/orders/from-website` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200/201
- [ ] –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç OK
- [ ] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π API –≤ –∫–æ–¥–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤ –±–∞–∑–µ
- [ ] –ú–∞—Å—Ç–µ—Ä–∞ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –ó–∞–∫–∞–∑—ã –≤–∏–¥–Ω—ã –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

---

## üìû –ü–æ–º–æ—â—å

### –î–æ–∫—É–º–µ–Ω—Ç—ã:
- **`FIX_BACKEND_404.md`** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é
- **`website/diagnose-backend.ps1`** - —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- **`POSTGRESQL_SERVER_SETUP.md`** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –ö–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
pm2 list                      # –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs backend --lines 100  # –õ–æ–≥–∏ backend
pm2 restart backend           # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 describe backend          # –î–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

# –õ–æ–∫–∞–ª—å–Ω–æ
.\diagnose-backend.ps1        # –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ API
Test-NetConnection -ComputerName 212.74.227.208 -Port 3000  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **Mock —Ä–µ–∂–∏–º** - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ frontend
2. **–ó–∞–∫–∞–∑—ã –≤ mock —Ä–µ–∂–∏–º–µ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –Ω—É–∂–µ–Ω —Ä–∞–±–æ—á–∏–π backend
4. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è backend **—É–¥–∞–ª–∏—Ç–µ** mock endpoint

---

**–°–æ–∑–¥–∞–Ω–æ:** 14.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Mock —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç, ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend  
**GitHub:** https://github.com/RubeRoid-creat/masterprofiapp  
**–ö–æ–º–º–∏—Ç:** b13b1d1

