// Пример mock-версии API для работы без БД
// Переименуйте этот файл в route.ts для использования без Prisma

import { NextRequest, NextResponse } from 'next/server'

// Временное хранилище в памяти (данные пропадут при перезапуске)
let mockOrders: any[] = []

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    
    const { address, equipmentType, problemType, brand, date, time, description, name, phone, email } = body

    // Валидация
    if (!address || !equipmentType || !problemType || !brand || !date || !time || !name || !phone) {
      return NextResponse.json(
        { error: 'Не все обязательные поля заполнены' },
        { status: 400 }
      )
    }

    // Создание заказа (в памяти)
    const order = {
      id: mockOrders.length + 1,
      address,
      equipmentType,
      problemType,
      brand,
      date: new Date(date),
      time,
      description: description || '',
      name,
      phone,
      email: email || '',
      status: 'new',
      createdAt: new Date(),
    }

    mockOrders.push(order)

    console.log('Mock order created:', order)

    return NextResponse.json({ success: true, orderId: order.id }, { status: 201 })
  } catch (error) {
    console.error('Error creating order:', error)
    return NextResponse.json(
      { error: 'Ошибка при создании заказа' },
      { status: 500 }
    )
  }
}

export async function GET(request: NextRequest) {
  try {
    return NextResponse.json(mockOrders.slice(-100).reverse())
  } catch (error) {
    console.error('Error fetching orders:', error)
    return NextResponse.json(
      { error: 'Ошибка при получении заказов' },
      { status: 500 }
    )
  }
}

