# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 404 –¥–ª—è /api/orders/from-website

## üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### –°–∏–º–ø—Ç–æ–º—ã:
- ‚úÖ Backend —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
- ‚úÖ –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–æ—É—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (`/api/orders`, `/api/masters` - –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 401)
- ‚ùå –†–æ—É—Ç `/api/orders/from-website` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404
- ‚ùå –†–æ—É—Ç `/api/auth/login` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404
- ‚ùå –†–æ—É—Ç `/api/version` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404

### –ü—Ä–∏—á–∏–Ω–∞:
Backend —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω, –Ω–æ **–Ω–µ –≤—Å–µ —Ä–æ—É—Ç—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã** –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ.

---

## üöÄ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
ssh root@212.74.227.208

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PM2
pm2 list

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
pm2 restart backend

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs backend --lines 50

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–æ—É—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -X POST http://localhost:3000/api/orders/from-website \
  -H "Content-Type: application/json" \
  -d '{"name":"Test","phone":"+79001234567","email":"test@test.com","device_type":"Test","device_brand":"Test","problem_description":"Test","address":"Test","latitude":55.751244,"longitude":37.618423,"desired_repair_date":"2025-12-15","arrival_time":"10:00","urgency":"planned","priority":"regular"}'
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ —Ä–æ—É—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª routes/orders.js —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–æ—É—Ç from-website
grep -A 10 "from-website" /path/to/backend/routes/orders.js

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
# router.post('/from-website', async (req, res) => {
#   try {
#     console.log('üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å —Å–∞–π—Ç–∞...');
#     ...
#   }
# });
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /path/to/backend
git pull origin main

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm install

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart backend

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs backend
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

```powershell
cd Z:\BestAPP\website
.\diagnose-backend.ps1
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
[4/5] Checking /api/orders/from-website endpoint...
  [OK] from-website endpoint works!
```

---

## üß™ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Mock –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–ü–æ–∫–∞ backend –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **mock endpoint** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è frontend:

### 1. –ò–∑–º–µ–Ω–∏—Ç—å URL –≤ –∫–æ–¥–µ

–í —Ñ–∞–π–ª–µ `website/lib/admin-api.ts`:

```typescript
// –í—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º mock endpoint
const ADMIN_API_URL = process.env.NEXT_PUBLIC_ADMIN_API_URL || 'http://localhost:3000/api';

// –í —Ñ—É–Ω–∫—Ü–∏–∏ sendOrderToAdmin –∏–∑–º–µ–Ω–∏—Ç–µ:
const response = await fetch(`/api/orders-mock`, { // –í–º–µ—Å—Ç–æ ${ADMIN_API_URL}/orders/from-website
  method: 'POST',
  // ...
});
```

### 2. Mock endpoint —É–∂–µ —Å–æ–∑–¥–∞–Ω

–§–∞–π–ª `website/app/api/orders-mock/route.ts` - –≤—Ä–µ–º–µ–Ω–Ω—ã–π endpoint –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∞–π—Ç
cd Z:\BestAPP\website
npm run dev

# –û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä: http://localhost:3000/order
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑
```

**Mock endpoint –±—É–¥–µ—Ç:**
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
- ‚ö†Ô∏è –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑—É (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è UI)

---

## üìã –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ü–æ–ª—É—á–µ–Ω SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É 212.74.227.208
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `pm2 restart backend`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏: `pm2 logs backend`
- [ ] –†–æ—É—Ç `/api/orders/from-website` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200/201
- [ ] –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç OK –¥–ª—è from-website
- [ ] Mock endpoint –æ—Ç–∫–ª—é—á–µ–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π backend)
- [ ] –ó–∞–∫–∞–∑—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

## üêõ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ —Ä–æ—É—Ç—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
pm2 logs backend --lines 100 | grep "–ú–∞—Ä—à—Ä—É—Ç—ã"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
pm2 describe backend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
netstat -tuln | grep 3000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
pm2 logs backend --err --lines 50
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ backend
pm2 env backend
```

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `.\diagnose-backend.ps1`
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤: `pm2 logs backend --lines 200 > backend-logs.txt`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Node.js –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `node --version` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å >= 18)

---

**–°–æ–∑–¥–∞–Ω–æ:** 14.12.2025  
**–ê–≤—Ç–æ—Ä:** Cursor AI  
**–í–µ—Ä—Å–∏—è:** 1.0

