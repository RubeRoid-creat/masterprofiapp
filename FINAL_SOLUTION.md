# ‚úÖ –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –° –ó–ê–Ø–í–ö–ê–ú–ò

## üéØ –ü–†–û–ë–õ–ï–ú–ê
–ó–∞—è–≤–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞, —Ö–æ—Ç—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–ò–ß–ò–ù–´:

### 1. ‚ùå –ò—Å—Ç–µ–∫—à–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏—Å—å
   - API –≤–æ–∑–≤—Ä–∞—â–∞–ª –≤—Å–µ pending –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –∏—Å—Ç–µ–∫—à–∏–µ
   - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–æ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞—è–≤–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å, —Ç–∞–∫ –∫–∞–∫ –≤—Å–µ –±—ã–ª–∏ –∏—Å—Ç–µ–∫—à–∏–º–∏

### 2. ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –ó–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —ç–∫—Ä–∞–Ω–∞
   - –ù–µ –±—ã–ª–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ polling
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 3. ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
   - –ù–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Å—Ç–µ—Ä–∞ –Ω–µ –º–æ–≥–ª–∏ –≤–∏–¥–µ—Ç—å –∑–∞—è–≤–∫–∏
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞—è–≤–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã

## ‚úÖ –í–ù–ï–°–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π (–°–ï–†–í–ï–†)
**–§–∞–π–ª:** `backend/routes/assignments.js`

```javascript
// –§–∏–ª—å—Ç—Ä—É–µ–º –∏—Å—Ç–µ–∫—à–∏–µ pending –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
const now = new Date();
const filteredAssignments = assignments
  .filter(assignment => {
    if (assignment.status === 'pending' && assignment.expires_at) {
      const expiresAt = new Date(assignment.expires_at);
      if (expiresAt < now) {
        return false; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏—Å—Ç–µ–∫—à–∏–µ
      }
    }
    return true;
  });
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π (–ö–õ–ò–ï–ù–¢)
**–§–∞–π–ª:** `app/src/main/java/com/example/bestapp/ui/orders/OrdersViewModel.kt`

```kotlin
// –§–∏–ª—å—Ç—Ä—É–µ–º –∏—Å—Ç–µ–∫—à–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
val activeAssignments = pendingAssignments.filter { assignment ->
    val expiresAt = assignment.expiresAt?.let { expiresStr ->
        // –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –∏—Å—Ç–µ–∫–µ–Ω–∏—è
        // ...
    }
    expiresAt != null && expiresAt > System.currentTimeMillis()
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–∞–∂–µ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω–µ—Ç –∏—Å—Ç–µ–∫—à–µ–µ, –∫–ª–∏–µ–Ω—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç.

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫
**–§–∞–π–ª:** `app/src/main/java/com/example/bestapp/ui/orders/OrdersViewModel.kt`

```kotlin
// Polling –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥, –∫–æ–≥–¥–∞ –º–∞—Å—Ç–µ—Ä –Ω–∞ —Å–º–µ–Ω–µ
private fun startPollingAssignments() {
    pollingJob = viewModelScope.launch {
        while (isActive && _isShiftActive.value) {
            delay(30000) // 30 —Å–µ–∫—É–Ω–¥
            if (_isShiftActive.value) {
                loadNewOrders()
            }
        }
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥.

### 4. –£–±—Ä–∞–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
**–§–∞–π–ª—ã:** `backend/routes/assignments.js`, `backend/routes/orders.js`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞—Å—Ç–µ—Ä–∞ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –∑–∞—è–≤–∫–∏ –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–æ –Ω–µ –º–æ–≥—É—Ç –∏—Ö –ø—Ä–∏–Ω–∏–º–∞—Ç—å).

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π:**
   - ‚úÖ –ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è –º–∞—Å—Ç–µ—Ä–∞–º
   - ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–∞
   - ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å —Å–º–µ–Ω—ã (`is_on_shift`)

2. **API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
   - ‚úÖ –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ (–Ω–µ –∏—Å—Ç–µ–∫—à–∏–µ) pending –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
   - ‚úÖ –í—Å–µ –ø—Ä–∏–Ω—è—Ç—ã–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
   - ‚úÖ –ò—Å—Ç–µ–∫—à–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

3. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
   - ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏—Å—Ç–µ–∫—à–∏–µ (–∑–∞—â–∏—Ç–∞)
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞—è–≤–∫–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
   - ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —ç–∫—Ä–∞–Ω–∞ (onResume)

## üß™ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:
```bash
cd backend
node scripts/verify-api-response.js
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ê–ö–¢–ò–í–ù–´–ï PENDING –ù–ê–ó–ù–ê–ß–ï–ù–ò–Ø:
   1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ #XX: –ó–∞–∫–∞–∑ #XX (–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
      –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: X –º–∏–Ω—É—Ç
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑:
```bash
cd backend
node scripts/create-test-order.js
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
- –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞
- –í–∫–ª—é—á–∏—Ç–µ —Å–º–µ–Ω—É
- –û—Ç–∫—Ä–æ–π—Ç–µ —ç–∫—Ä–∞–Ω –∑–∞—è–≤–æ–∫
- **–ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥**

## üì± –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø –ú–ê–°–¢–ï–†–ê:

1. **–û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
2. **–í–∫–ª—é—á–∏—Ç–µ —Å–º–µ–Ω—É:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å —Å–º–µ–Ω—É"
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é:**
   - –ü—Ä–æ—Ñ–∏–ª—å ‚Üí –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
   - –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Ö–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ä–µ–º–æ–Ω—Ç–∏—Ä—É–µ—Ç–µ
4. **–û—Ç–∫—Ä–æ–π—Ç–µ —ç–∫—Ä–∞–Ω –∑–∞—è–≤–æ–∫:**
   - –ó–∞—è–≤–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

## üêõ –ï–°–õ–ò –ó–ê–Ø–í–ö–ò –í–°–ï –ï–©–ï –ù–ï –ü–û–Ø–í–õ–Ø–Æ–¢–°–Ø:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Logcat):
- –§–∏–ª—å—Ç—Ä: `OrdersViewModel` –∏–ª–∏ `ApiRepository`
- –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
  - `üîÑ –ó–∞–ø—Ä–æ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π`
  - `‚úÖ –ü–æ–ª—É—á–µ–Ω–æ X –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π`
  - `‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π: X`

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤ –ë–î:
```bash
cd backend
node scripts/check-assignments.js
```

### 3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- ‚úÖ –ú–∞—Å—Ç–µ—Ä –Ω–∞ —Å–º–µ–Ω–µ (`is_on_shift = 1`)
- ‚úÖ –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ –∏—Å—Ç–µ–∫—à–∏–µ)
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–∏–ø—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∑–∞–∫–∞–∑–µ

## üìã –§–ê–ô–õ–´ –° –ò–ó–ú–ï–ù–ï–ù–ò–Ø–ú–ò:

### Backend:
- `backend/routes/assignments.js` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- `backend/routes/orders.js` - —É–±—Ä–∞–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### Frontend:
- `app/src/main/java/com/example/bestapp/ui/orders/OrdersViewModel.kt` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö, polling
- `app/src/main/java/com/example/bestapp/api/ApiRepository.kt` - —É–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–∫—Ä–∏–ø—Ç—ã:
- `backend/scripts/verify-api-response.js` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ API
- `backend/scripts/create-test-order.js` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- `backend/scripts/check-assignments.js` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π

## ‚úÖ –ò–¢–û–ì:

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é:**
- ‚úÖ –ò—Å—Ç–µ–∫—à–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–æ–∫
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ Git –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**


